# 简介
网上能用好用的脚手架一大堆，我又为什么要重复的做这个东西呢？

首先，我认为一个自己经常使用的东西，自己是有必要去了解的，是可以随心所欲的为已所用的，是可以随手增减改造的。还好，「webpack」的官方文档写得还行，我可以选择造一个更适合自己的，更简洁明了的，一步到位的。

当然还有我认为最重要的"规范"，这些规范分为三类："目录结构规范"、"代码规范"、"组件规范"。其实没有这些规范也能完成项目，但终究只是自己一时写得爽快，这时如果别人有幸接手了这样的项目，肯定会疯狂吐嘈的，因为我认识的人，包括我自己都是这样过来的。如果是在多人项目中，那整个项目就更是混乱，需要花费较多的时间在不必要的沟通上。

「Server-Side-Render」这个功能我也给做到里面去了。现在还是有许多的前端项目十分注重 'SEO'，如果我们还想继续使用现在流行的框架，就只能通过「服务端渲染」来满足 'SEO' 这个需求了。我选择做到一起的原因是，「客户端渲染」和「服务端渲染」在写法上差异性并不是很大，完全可以只写一套代码，慢慢决定采用「客户端渲染」还是「服务端渲染」。

### 目录结构
'/server'
这个文件下面都是跑在服务端的，因为其中包含 'react' 代码，所以会提前使用 'webpack' 打包后再运行。结构比较简单，可以很方便的拓展来支持更多的服务端需求。

'/src'
这个下面就全都是前端项目文件。对于项目中的文件放置问题，我认为还是有必要约束一下。在我们的工作中，不可避免的都会接手别人的项目，或者是多人项目，或者是帮别人解决个BUG，都会花比较长的时间来了解项目的基本情况，来找到别人写的关键部分到底在哪。这样一团糟的项目，相信不管是谁沾上了都会感到头痛。

所以我们需要对整个项目的结构做一定的约束，统一管理起来。

- index.js 自然不用说，属于项目入口的文件，所有的起点都在这里，统一做一些初始化工作，例如加载各种依赖、加载状态管理库等等
- assets '公共'资源文件。请注意公共二字我特别打上了重点，其原因是很多开发人员将组件级别的资源文件放置到了公共资源文件进行统一的管理，但是在实践中我并不认为这是一个特别好的选择。与组件强依赖的资源文件我认为和组件一起放置在一个文件夹内，能够更快、更容易的进行管理。只有通用的公共文件才会放在这里来。
- pages 和 components 文件夹，前者放置的是页面以及页面强依赖的组件，例如注册页面 login，用户管理界面 user 等等。后者则放置的是公共组件。与公共资源文件一样，强依赖的组件就应该和其页面在同一个文件夹中去管理。


```text
├── build                       // webpack 配置相关
│   ├── webpack.base.conf.js    // 基础webpack配置，被其他配置所依赖
│   ├── webpack.dev.conf.js     // 「webpack-dev-server」配置，本地开发使用
│   ├── webpack.prod.conf.js    // 打包静态文件配置
│   ├── webpack.client.conf.js  // 「ssr」客户端的配置
│   └── webpack.server.conf.js  // 「ssr」服务端的配置
├── server                      // 服务端相关
│   ├── controller              // 控制器，用于数据处理返回
│   │   └── default.js          // 默认返回资源--在服务端生成页面
│   ├── util                    // 工具类文件
│   └── index.js                // 服务端入口
└── src                         // 客户端相关
    ├── assets                  // 公共资源文件
    ├── components              // 项目公共组件
    ├── options                 // 一些辅助的文件
    ├── controller              // 控制器，用于数据管理
    ├── pages                   // 页面具体逻辑
    ├── router                  // 路由
    ├── store                   // 状态管理
    ├── util                    // 工具类文件
    ├── index.html              // 需要提前写入的html配置，都可以写在这里面，所有生成的新html文件都以这个为基础
    ├── index.js                // 项目入口
    └── ssr.entry.js            // 「ssr」项目入口
```

### 代码规范
代码规范工具使用的是「eslint」，代码规则来源的是据说最严格的「airbnb」，当然最严格的并不一定是最好的，所以我也根据我个人的习惯修改了部分的规则。如果你在使用中对其中的规则有自己看法、有意见，也可以提给我，我们一起来修改「代码规则」，让它用起来更得心应手。

「eslint」的依赖和配置这里都已弄好了，只需要在你的编辑器上面安装「eslint」插件即可使用，目前「webstorm」、「vscode」等主流的编辑器上都有这款插件，我使用的是「atom」。

规则写在 '/.eslintrc' 中，如果你需要，可以直接修改。如果你不知道该如何添加修改，可以上这里看看[eslint中文](http://eslint.cn/)。

### 组件规范
每个人对于如何分组件的看法都不一样，但还是有个公认的做法，那就是单个文件不应该超过 250 行代码(不包含注释)，对于目前的框架而言，250 行能够做成很多很多的事情，超过 250 行的 js 文件，应该思考如何进行拆分、剔除重复性逻辑。

当然你也可以参考有人气的 UI 框架(例如 antd、element)，结合自己的使用感受，学习他们是如何做组件的，能在一大堆产品的脱颖而出，说明在使用上存在明显的优势，我有时候也会模仿他们的组件来开发。

### 可配置项
/build/webpack.base.conf.js
这个是 webpack 的基础配置文件，被其他配置文件所依赖，有下列几个可配置部分：

1、输出文件路径
```javascript
// 静态文件路径，在 dev-server 模式中为空，不然会报文件路径错误
// 被下面 output 配置所依赖，决定了生产环境下静态文件的路径
const staticPath = devMode ? 'static/' : '';
```

2、输出文件路径
```javascript
output: {
    path: path.resolve(__dirname, '../dist/', staticPath), // 这里设置输出文件路径
    filename: 'js/[name].[hash:8].js',
    chunkFilename: 'js/[name].[hash:8].js',
    publicPath: `/${staticPath}` // 这里可设置项目 '绝对路径' 和 '相对路径'
},
```

3、loader 相关
这里放置的都是loader相关的配置，使用了 'sass'、'postcss' 等，如需其他配置，请自行添加，可参考[loader](https://webpack.docschina.org/concepts/loaders/#%E7%A4%BA%E4%BE%8B)。
```javascript
module: {
    rules: [
        ...
    ]
},
```


、


、
